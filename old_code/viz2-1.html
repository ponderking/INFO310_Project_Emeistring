<!DOCTYPE html>
<html lang="en"> <head>
    <meta charset="utf-8">
    <title>eMeistring Dashboard Demonstration</title>
    <script type="text/javascript" src="d3/d3.min.js"></script>
    <link rel="stylesheet" href="css/dashboard.css">
</head>
<body>

<img style="position:fixed; top:0px; left:0px; width:1150px; height:680px; border:none;" src="img/checkwarebck.png">

<svg style="position:fixed; top:177px; left:310px; width:570px; height:170px; border:none;" >
    <rect fill="white" width="540" height="170"></rect>
    <rect x="30" y="50" fill="lightgrey" stroke-width="2" stroke="black" width="480" height="70"></rect>
    <g id="startWeek" transform="translate(10, 10)">
        <text transform="rotate(90)" style="text-anchor:end;" x="115" y="-4" fill="black" font-size="11"  font-family="Arial">14.01.20</text>
    </g>
    <g id="endWeek" transform="translate(510, 10)">
        <text transform="rotate(90)" style="text-anchor:end;" x="115" y="-4" fill="black" font-size="11"  font-family="Arial">28.04.20</text>
    </g>
    <g id="thisweek" transform="translate(35, 10)"></g>
    <g id="modules" transform="translate(35, 30)"></g>
    <g transform="translate(30, 30)">
        <path id="week0" ></path>
        <path id="week1" ></path>
        <path id="week2" ></path>
        <path id="week3" ></path>
        <path id="week4" ></path>
        <path id="week5" ></path>
        <path id="week6" ></path>
        <path id="week7" ></path>
        <path id="week8" ></path>
        <path id="week9" ></path>
        <path id="week10" ></path>
        <path id="week11" ></path>
        <path id="week12" ></path>
        <path id="week13" ></path>
    </g>
    <g id="message1" transform="translate(30, 28)"></g>
    <g id="message2" transform="translate(30, 30)"></g>

</svg>

<div style="position:fixed; top:64px; left:10px; width:200px; height:60px; border:none;">
    <span class="dlink" onclick="location.href='viz4.html';"></span>
</div>

<div style="position:fixed; top:0px; left:47px; width:70px; height:90px; border:none;">
    <span class="hlink" onclick="location.href='viz1-3.html';"></span>
</div>


<div id="tooltip" class="hidden">
    <p><span id="value">100</span></p>
</div>


<!--div id="myDIV" onclick="location.href='viz2.html';"></div-->

<script type="text/javascript">

// 12 5 8
var moduledata=[ "Module 1, Status: Finished. Submitted on 15.01.20",
                 "Module 2, Status: Finished. Submitted on 29.01.20",
                 "Module 3, Status: Finished. Submitted on 12.02.20",
                 "Module 4, Status: Finished. Submitted on 26.02.20",
                 "Module 5, Status: Finished. Submitted on 11.03.20",
                 "Module 6, Status: Incomplete. Due on 25.03.20",
                 "Module 7, Status: Incomplete. Due on 14.04.20",
                 "Module 8, Status: Incomplete. Due on 28.04.20"
                ];

    var modules = [2, 2, 2, 2, 2, 1, 1, 0];   // modules completed ... 2 for completed, 1 for not submitted
    var weeks   = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0];   // weeks elapsed...  1 for elapsed

    var totalDays = 14 * 7;
    var currentDay = 77; // any number in between 0 - totalDays
    var msg1 = [0, 1, 2, 3.7, 4.5, 5.5, 7.5, 9.8];
    var msg2 = [1, 2.5, 4, 6, 7];

    var xRange = 450;
    var xInit = 30;
    var yInit = 80;
    var buffer = 7;
    var buffer2 = buffer * 2;
    var posX = xInit + (xRange / totalDays ) * currentDay;

d3.select('#thisweek').append("text")
    .attr("x", posX - 10)
    .attr("y", 150)
    .attr("font-size", 11)
    .text("14.04.20");


    d3.select('#thisweek').selectAll("image").data([0])
        .enter()
        .append("image")
        .attr("xlink:href", "img/position.png")
        .attr("x", posX)
        .attr("y", 0)
        .attr("width", "30");

    d3.select('#thisweek').append("line")
        .attr("x1", posX + 15)
        .attr("y1", 30)
        .attr("x2", posX + 15)
        .attr("y2", 140)
        .attr("stroke", "black")
        .attr("stroke-dasharray", 4)
        .attr("stroke-width", 3);



    d3.select('#modules').selectAll("circle").data(modules)
        .enter()
        .append("circle")
        .attr("cx", function(d, i){
            return xInit + i * (xRange / 8);
        })
        .attr("cy", 40)
        .attr("r", 8)
        .attr("stroke", "black")
        .attr("fill", function(d, i){
            if(d == 2)
            return "green";
            else if(d==1)
                return "orange";
            else return "grey";
        })
        .on("mouseover", function(d, i) {
            //d3.select(this)
                //.attr("fill", "#933833");
            var xPosition = window.event.clientX; // 250 + d.outerRadius * Math.cos( Math.PI * i * (360/12) / 180) ;
            var yPosition = window.event.clientY; //  245 + d.outerRadius * Math.sin( Math.PI * i * (360/12) / 180) ;
            //Update the tooltip position and value
            d3.select("#tooltip")
                .style("left", xPosition + "px")
                .style("top", yPosition + "px")
                .select("#value")
                .text(moduledata[i]);
            d3.select("#tooltip")
                .classed("hidden", false);
        })
        .on("mouseout", function(d, i) {
            /*var c = "green";
            if(d == 2)
                c = "green";
            else if(d==1)
                c = "orange";
            else c = "grey";

            d3.select(this)
                .attr("fill", c);*/
            d3.select("#tooltip").classed("hidden", true);
        });

    var lineGenerator = d3.line()
        .defined(function(d) {
            return d !== null;
        });

    for (var i = 0; i < 14; i++) {

        var points = [];
        xPos = xInit + i * (xRange / 14);
        var xpos1 = xPos;
        var ypos1 = yInit;
        var xpos2 = xpos1 + buffer;
        var ypos2 = yInit;
        points.push([xpos1, ypos1]);
        points.push([xpos2, ypos2]);
        points.push([xpos2+buffer, ypos2-buffer]);
        points.push([xpos2, ypos2-buffer2]);
        points.push([xpos1, ypos2-buffer2]);
        points.push([xpos2, ypos2-buffer]);
        points.push([xpos1, ypos1]);
        points.push(null);

        var pathData = lineGenerator(points);

        // Create a path element and set its d attribute
        var segName = '#week' + i;
        var wcolor = "green";
        if(weeks[i] == 0)
            wcolor = "lightgrey";

        d3.select(segName)
            .attr('stroke', "black")
            .attr('fill', wcolor)
            .attr('d', pathData);

    }




    var xImg1 = 10;
    var yImg1 = 0;

    d3.select('#message1').selectAll("image").data(msg1)
        .enter()
        .append("image")
        .attr("xlink:href", "img/message4.png")
        .attr("x", function (d) {
            return xImg1 + d * (xRange / 14);
        })
        .attr("y", yImg1)
        .attr("width", "20")
        .attr("height", "20");




    var xImg2 = 10;
    var yImg2 = 90;

    d3.select('#message2').selectAll("image").data(msg2)
        .enter()
        .append("image")
        .attr("xlink:href", "img/message1.png")
        .attr("x", function (d) {
            return xImg2 + d * (xRange / 14);
        })
        .attr("y", yImg2)
        .attr("width", "20")
        .attr("height", "20");

</script>


<script>

    // 2. Use the margin convention practice
    var margin = {top: 50, right: 40, bottom: 50, left: 40}
        , width = 540 - margin.left - margin.right // Use the window's width
        , height = 220 - margin.top - margin.bottom; // Use the window's height


    // X scale will use the index of our data
    var xScale = d3.scaleLinear()
        .domain([0, 14]) // input
        .range([0, width]); // output

    // 6. Y scale will use the randomly generate number
    var yScale = d3.scaleLinear()
        .domain([0, 35]) // input
        .range([height, 0]); // output

    // 7. d3's line generator
    var line = d3.line()
        .x(function(d, i) { return xScale(i); }) // set the x values for the line generator
        .y(function(d) { return yScale(d.y); }) // set the y values for the line generator
        .curve(d3.curveMonotoneX) // apply smoothing to the line

    // 8. An array of objects of length N. Each object has key -> value pair, the key being "y" and the value is a random number
    var dataset =  [{"x" : 1, "y": 33},
        {"x" : 2, "y": 32},
        {"x" : 3, "y": 33},
        {"x" : 4, "y": 30},
        {"x" : 5, "y": 29},
        {"x" : 6, "y": 28},
        {"x" : 7, "y": 22},
        {"x" : 8, "y": 23},
        {"x" : 9, "y": 21},
        {"x" : 10, "y": 20},
        {"x" : 11, "y": 19}];


    // 1. Add the SVG to the page and employ #2
    var svg = d3.select("body").append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .attr("top", 500)
        .attr("left", 250)
        .attr("class", "graph-svg-component")
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


    svg.selectAll("text")
        .data(dataset)
        .enter().append("text") // Uses the enter().append() method
        .attr("x", function(d, i) { return xScale(i)-5 })
        .attr("y", function(d) { return yScale(d.y)-5 })
        .style("font-size", 10)
        .text(function(d,i){ if(i==0) return ""; else return d.y});

    // 3. Call the x axis in a group tag
    svg.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(d3.axisBottom(xScale)); // Create an axis component with d3.axisBottom


    // 4. Call the y axis in a group tag
    svg.append("g")
        .attr("class", "y axis")
        .call(d3.axisLeft(yScale)); // Create an axis component with d3.axisLeft


    // 9. Append the path, bind the data, and call the line generator
    svg.append("path")
        .datum(dataset) // 10. Binds data to the line
        .attr("class", "line") // Assign a class for styling
        .attr("d", line); // 11. Calls the line generator

    svg.append("path")
        .datum([{"y": 7}, {"y": 7}, {"y": 7}, {"y": 7}, {"y": 7}, {"y": 7},
            {"y": 7}, {"y": 7}, {"y": 7}, {"y": 7}, {"y": 7}, {"y": 7},
            {"y": 7}, {"y": 7}, {"y": 7}]) // 10. Binds data to the line
        .attr("class", "lineAxis") // Assign a class for styling
        .attr("d", line); // 11. Calls the line generator

    svg.append("path")
        .datum([{"y": 12}, {"y": 12}, {"y": 12}, {"y": 12}, {"y": 12}, {"y": 12},
            {"y": 12}, {"y": 12}, {"y": 12}, {"y": 12}, {"y": 12}, {"y": 12},
            {"y": 12}, {"y": 12}, {"y": 12}]) // 10. Binds data to the line
        .attr("class", "lineAxis") // Assign a class for styling
        .attr("d", line); // 11. Calls the line generator


    svg.append("path")
        .datum([{"y": 23}, {"y": 23}, {"y": 23}, {"y": 23}, {"y": 23}, {"y": 23},
            {"y": 23}, {"y": 23}, {"y": 23}, {"y": 23}, {"y": 23}, {"y": 23},
            {"y": 23}, {"y": 23}, {"y": 23}]) // 10. Binds data to the line
        .attr("class", "lineAxisOrange") // Assign a class for styling
        .attr("d", line); // 11. Calls the line generator

    svg.append("path")
        .datum([{"y": 30}, {"y": 30}, {"y": 30}, {"y": 30}, {"y": 30}, {"y": 30},
            {"y": 30}, {"y": 30}, {"y": 30}, {"y": 30}, {"y": 30}, {"y": 30},
            {"y": 30}, {"y": 30}, {"y": 30}]) // 10. Binds data to the line
        .attr("class", "lineAxisPink") // Assign a class for styling
        .attr("d", line); // 11. Calls the line generator


    svg.append("path")
        .datum([{"y": 35}, {"y": 35}, {"y": 35}, {"y": 35}, {"y": 35}, {"y": 35},
            {"y": 35}, {"y": 35}, {"y": 35}, {"y": 35}, {"y": 35}, {"y": 35},
            {"y": 35}, {"y": 35}, {"y": 35}]) // 10. Binds data to the line
        .attr("class", "lineAxisRed") // Assign a class for styling
        .attr("d", line); // 11. Calls the line generator




    // 12. Appends a circle for each datapoint
    svg.selectAll(".dot")
        .data(dataset)
        .enter().append("circle") // Uses the enter().append() method
        .attr("class", function(d){
            console.log(d.y);
            if(d.y >= 0 && d.y <= 22)
                return "dotNoDep";
            if(d.y >= 23 && d.y <= 29)
                return "dotSlDep";
            if(d.y >= 30 && d.y <= 34)
                return "dotModDep";
            if(d.y >= 35 )
                return "dotDep";
         })
        .attr("cx", function(d, i) { return xScale(i) })
        .attr("cy", function(d) { return yScale(d.y) })
        .attr("r", 5);

</script>


</body>
</html>


